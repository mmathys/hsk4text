{"version":3,"sources":["Text.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["shouldUsePrefix","lines","map","l","split","length","reduce","p","n","Text","props","useState","text","setText","splitFirst","x","arr","trim","prefix","rest","slice","c","useEffect","a","key","getKey","config","fetch","res","prefixed","unprefixed","fetchText","className","row","PauseKeys","SkipLeftKeys","SkipRightKeys","lesson","App","setConfig","activeText","setActiveText","selectedLesson","setSelectedLesson","audioRef","useRef","json","fetchData","useKeyPress","event","type","includes","current","paused","play","pause","currentTime","selectLesson","lesson_num","subitems","entries","entryClassName","entry","onClick","load","grouped","_","groupBy","texts","keys","parseInt","nav","title","controls","ref","src","content","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.d6161bbd.chunk.js","sourcesContent":["import { useEffect, useState } from \"react\";\nimport { getKey, TextConfig } from \"./App\";\nimport \"./Text.css\";\n\ntype TextProps = {\n  config: TextConfig;\n};\n\nconst shouldUsePrefix = (lines: string[]) => {\n  const validLine = lines.map((l) => {\n    const arr = l.split(\"：\");\n    if (arr[0].length <= 4) return true;\n    else return false;\n  });\n\n  return validLine.reduce((p, n) => p && n);\n};\n\nexport function Text(props: TextProps) {\n  const [text, setText] = useState<string[][]>();\n\n  const splitFirst = (x: string) => {\n    const arr = x.split(\"：\");\n    if (arr.length === 1) return [\"\", arr[0].trim()];\n    else {\n      const prefix = arr[0] + \"：\";\n      const rest = arr.slice(1).reduce((p, c) => p + \"：\" + c);\n      return [prefix.trim(), rest.trim()];\n    }\n  };\n\n  useEffect(() => {\n    const fetchText = async () => {\n      const key = getKey(props.config);\n      const res = await fetch(`text/${key}.txt`);\n      const text = await res.text();\n      const lines = text.split(\"\\n\");\n      if (shouldUsePrefix(lines)) {\n        const prefixed = lines.map(splitFirst);\n        setText(prefixed);\n      } else {\n        const unprefixed = lines.map((l) => [\"\", l]);\n        setText(unprefixed);\n      }\n    };\n\n    fetchText();\n  }, [props]);\n\n  return (\n    <div>\n      <div className=\"table\">\n        {text?.map((row) => {\n          return (\n            <div key={row[1]} className=\"row\">\n              <p className=\"cell dialog-head\">{row[0]}</p>\n              <p className=\"cell\">{row[1]}</p>\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n}\n","import { useEffect, useRef, useState } from \"react\"\nimport { useKeyPress } from \"react-use\"\nimport \"./App.css\"\nimport { Text } from \"./Text\"\nimport _ from \"lodash\"\n\nconst PauseKeys = [\"k\", \"space\"]\nconst SkipLeftKeys = [\"j\", \"left\"]\nconst SkipRightKeys = [\"l\", \"right\"]\n\nexport type TextConfig = {\n  lesson: number\n  text: number\n  title: string | undefined\n}\n\ntype Config = {\n  texts: [TextConfig]\n}\n\nexport function getKey(config: TextConfig | undefined) {\n  if (!config) return\n  return (config.lesson < 10 ? \"0\" : \"\") + config.lesson + \"-\" + config.text\n}\n\nfunction App() {\n  const [config, setConfig] = useState<Config>()\n  const [activeText, setActiveText] = useState<TextConfig>()\n  const [selectedLesson, setSelectedLesson] = useState<number>(-1)\n  const audioRef = useRef<HTMLAudioElement>(null)\n\n  useEffect(() => {\n    const fetchData = async () => {\n      const res = await fetch(\"config.json\")\n      const json: Config = await res.json()\n      setConfig(json)\n    }\n\n    fetchData()\n  }, [])\n\n  const setText = (entry: TextConfig) => {\n    setActiveText(entry)\n    if (audioRef.current) {\n      audioRef.current.load()\n    }\n  }\n\n  const nav = () => {\n    if (!config) return\n\n    const selectLesson = (lesson_num: number) => () => {\n      if (lesson_num === selectedLesson) {\n        setSelectedLesson(-1)\n      } else {\n        setSelectedLesson(lesson_num)\n      }\n    }\n\n    const subitems = (entries: TextConfig[], lesson_num: number) => {\n      if (lesson_num !== selectedLesson) return\n      const entryClassName = (entry: TextConfig) => \"nav-entry\" + (entry === activeText ? \" active\" : \"\")\n      return entries.map((entry) => (\n        <div className={entryClassName(entry)} key={getKey(entry)} onClick={() => setText(entry)}>\n          Text {entry.text}\n        </div>\n      ))\n    }\n\n    const grouped = _.groupBy(config.texts, (c: TextConfig) => c.lesson)\n    const keys = _.keys(grouped)\n    return keys.map((lesson: string) => {\n      const lesson_num = parseInt(lesson)\n      const entries = grouped[lesson]\n      const className = \"nav-lesson\" + (lesson_num === activeText?.lesson ? \" active\" : \"\")\n      return (\n        <div key={lesson}>\n          <p className={className} onClick={selectLesson(lesson_num)}>\n            Lesson {lesson}\n          </p>\n          {subitems(entries, lesson_num)}\n        </div>\n      )\n    })\n  }\n\n  const content = () => {\n    if (!activeText) return\n    const title = () => {\n      if (!activeText.title) return\n      else return <p className=\"title\">{activeText.title}</p>\n    }\n    return (\n      <div className=\"text chinese\">\n        {title()}\n        <Text config={activeText}></Text>\n        <audio className=\"audio\" controls ref={audioRef}>\n          <source src={`audio/${getKey(activeText)}.mp3`} type=\"audio/mpeg\" />\n          Your browser does not support the audio element.\n        </audio>\n      </div>\n    )\n  }\n\n  useKeyPress((event) => {\n    if (event.type !== \"keydown\") return false\n    if (PauseKeys.includes(event.key)) {\n      if (audioRef.current?.paused) audioRef.current?.play()\n      else audioRef.current?.pause()\n    }\n\n    if (audioRef.current) {\n      if (SkipLeftKeys.includes(event.key)) audioRef.current.currentTime -= 5\n      if (SkipRightKeys.includes(event.key)) audioRef.current.currentTime += 5\n    }\n\n    return true\n  })\n\n  return (\n    <div className=\"App\">\n      <div className=\"content\">\n        <div className=\"nav\">{nav()}</div>\n        {content()}\n      </div>\n    </div>\n  )\n}\n\nexport default App\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}